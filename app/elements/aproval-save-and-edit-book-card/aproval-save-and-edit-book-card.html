<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="..\..\bower_components/polymer/polymer.html">

<dom-module id="aproval-save-and-edit-book-card">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <div>
        <paper-input hidden value="{{captheadid}}"></paper-input>
        <paper-checkbox on-change="fnsezzt" checked="{{check}}"  id="{{id}}">{{valuename}}
    </div>
    <iron-ajax
        method="post"
        id="fnsetzajax"
        url="{{fnsetzurl}}"
        params="{{fnsetzparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="fnsetzResponse"
        debounce-duration="300">
</iron-ajax> 
  </template>
  <script>
  (function() {
    'use strict';
var v=[];
var val1=[];

    Polymer({
      is: 'aproval-save-and-edit-book-card',
ready:function(e){

   this.fnsetz();
},
fnsezzt:function(e){
     if(document.querySelector('#'+this.id).checked==true)
      {
         var obj={"value_id":"","value_name":"","capter_id":"","id":""};
            obj.value_id=this.valueid;
            obj.value_name=this.valuename;
            obj.capter_id=this.captheadid;
            obj.id=this.id;
            val1.push(obj);
            v.push(obj);
           }

      else if(document.querySelector('#'+this.id).checked==false)
      {
           for( var i=0;i<val1.length;i++){
                if(val1[i].id==this.id){
                  val1.splice(i,1);
                }
           }
        
       }
   
 document.querySelector('skill-capturing-card').fnsetvalue(val1);
   
   
},
fnsetz:function(e){
  //alert('1');
  this.fnsetzurl=sessionStorage.getItem("addrinfo")+"/fnsetz-service";
      var obj={};
      obj.concept_id=localStorage.getItem("curr_sess_conceptid");
      obj.capter_id=localStorage.getItem("curr_sess_capters");
      obj.emp_id=sessionStorage.getItem("curr_sess_loggedid");
      obj.grade_id=sessionStorage.getItem("grdeidz");
      obj.subject_id=sessionStorage.getItem("subjectidz");
      obj.section_id=sessionStorage.getItem("sectoinidz");
      obj.school_id=sessionStorage.getItem("curr_sess_loggedschoolid");
      obj.academic_year=localStorage.getItem("curr_sess_academicyear");
      obj.flag='active';  
      this.fnsetzparam=obj;
      this.$.fnsetzajax.generateRequest();
},
fnclearx:function(e){
       for(var i=0;i<v.length;i++){
         var xx=v[i].id;
         document.querySelector('#'+xx).checked=false; 
          }
         var obj={};
          v.splice(obj);
         val1.splice(obj);

},
fnsetzResponse:function(e){
   var res=e.detail.response.returnval;
       for(var i=0;i<res.length;i++){
           var obj={};
           var  mz=res[i].capter_id+res[i].concept_id+res[i].value_id;
                document.querySelector('#'+mz).checked=true; 
     
           obj.id=mz;
           v.push(obj);
        }
     },
    
});
  })();
  </script>
</dom-module>
